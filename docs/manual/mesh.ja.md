# Mesh

**メッシュ** とそれに対応する **メッシュ** は、3D環境と他のオブジェクトを定義します。

---
## マークアップ

メッシュは衝突のためだけに使われるので、モデルの開発はあまり必要ありません。問題は、2Dスプライトに基づいてモデルの寸法をどのように定義するかだ。解決策は「マークアップ」だ。

基本的な3Dブロックは1x1x1メートルで、これは（遠近法がないため）正射投影では2つの2Dタイルに相当する：

![Pasted image 20250301111246.png](../assets/images/pasted-images/Pasted%20image%2020250301111246.png)

!!!note
	タイルのサイズは重要ではありません。この場合、16x16の1タイル（上がライト）。32x32、48x48、64x64など、1x1x1メートルのブロックに相当するものを使うこともできる。

もちろん、あなたのゲームでは正射投影は使わず、通常の遠近法を使うだろう。とはいえ、これは技術的な観点から重要なことで、タイル自体は好きなように描くことができる。

---
### デザイナー

コンストラクターとしてオブジェクトのメッシュを構築できる単純なケースを考えてみよう：

![Pasted image 20250301114628.png](../assets/images/pasted-images/Pasted%20image%2020250301114628.png)

!!!note
	個々のタイルから3次元環境を構築し、それにメシャ・ライブラリの要素を添付するとき、エディターでも似たようなことをすることになる。

---
### 比率

特に複雑なオブジェクトの場合、コンストラクタ・メソッドが常に機能するとは限らない。

つまり、選択したサイズ（たとえば16x16）のベースタイルがあり、これは1x1x1メートルのブロックを指している。このようにしてプロポーションが形成される：

```
16 -> 1 метр

16 -> 1 метр
```

ここで、直交投影を考慮して、ある要素のサイズをピクセルごとに計算する必要がある。つまり、前面と上面の幅と高さである：

![Pasted image 20250301203823.png](../assets/images/pasted-images/Pasted%20image%2020250301203823.png)

その割合に従って、各軸に必要なサイズをメートル単位で計算する：

X 軸の場合：

```
16 -> 1 米

27 -> X 米

X = (27*1)/16 = 1.6875
```

Y 軸の場合：

```
16 -> 1 米

15 -> Y 米

Y = (15*1)/16 = 0.9375
```

Z 軸の場合：

```
16 -> 1 米

15 -> Z 米

Z = (15*1)/16 = 0.9375
```

ここで、取得したデータに基づいてモデルを作成する：

![Pasted image 20250302112143.png](../assets/images/pasted-images/Pasted%20image%2020250302112143.png)

---
### イメージ

プロポーションには、スプライトそのものを使うという、よりシンプルな方法もあります。
これは、すでに描かれているスプライトをもとにモデルを作成し、希望のサイズに拡大縮小するというものです。

例えば、三菱 零戦はこうして作った：

![Pasted image 20250302153040.png](../assets/images/pasted-images/Pasted%20image%2020250302153040.png)

![Zero.png](../assets/images/Zero.png)

---
## エクスポート
### MeshLibrary

メシャ・ライブラリーについては、実装の余地がある。

この例では、まず blender でメッシュを作成します。そのためには、新しいジオメトリを追加して、その頂点を編集するだけです。このような構造になるはずです：

![Pasted image 20250301124539.png](../assets/images/pasted-images/Pasted%20image%2020250301124539.png)

---

それではエクスポートに移りましょう。この例では、**.blend** または **.glb** 形式を使用します：

1. インポートしたファイルを右クリックし、"New Inherited Scene"
2. すべての **MeshInstance3D** ブロックをハイライトし、画面上部の "Mesh "をクリックしてコリジョンシェイプを作成します。
3. 各 **MeshInstance3D** ブロックに対して、**StaticBody3D** を作成し、コリジョンメッシュをそこにドロップします。

これで準備は完了だ！あとは、「Scene 」セクションをクリックして、「Export As 」で 「Mesh Library 」を選択して、メッシュライブラリをエクスポートするだけです。

!!!tip
	ブロックの中心はエディター内のスペースの中心と一致しなければならない。

---
### OBJ

オブジェクトには OBJ フォーマットを使用する。

1. マッシュを作る。
2. .obj**フォーマットでエクスポートします。
3. Godot エディタで、シーンに **MeshInstance3D** を追加します。
4. インポートした OBJ メッシュをクランプし、**MeshInstance3D**  にドロップします。

その後、前の見出しで示したようにメッシュを生成し、この2つのオブジェクトをコアに配置する。

!!!tip
	ブロックの底は、エディター上の空間の水平面と一致させる。将来的には、もちろんメッシュの位置を変更することができますが、これは利便性と時間の節約の問題です。